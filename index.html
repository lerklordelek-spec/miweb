<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Corazón Animado</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');

  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  html, body {
    height: 100%;
    background: #000;
    font-family: 'Poppins', sans-serif;
    color: #eee;
    overflow: hidden;
    user-select: none;
  }
  #canvas {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    display: block;
    z-index: 1;
    background: #000;
  }
  #mainText {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #d26a5a;
    font-size: 1.5rem;
    font-weight: 600;
    text-align: center;
    max-width: 90vw;
    z-index: 5;
    user-select: none;
    line-height: 1.4;
    letter-spacing: 0.02em;
    text-shadow: 0 0 4px #b84e42aa;
    animation: pulseText 3s ease-in-out infinite;
    opacity: 1;
    transition: opacity 0.8s ease;
    display: none;
  }
  @keyframes pulseText {
    0%, 100% { opacity: 0.9; }
    50% { opacity: 1; }
  }
  #buttons {
    position: fixed;
    bottom: 30px;
    width: 100%;
    text-align: center;
    z-index: 10;
    display: none;
    gap: 30px;
  }
  button {
    font-family: 'Poppins', sans-serif;
    font-weight: 700;
    font-size: 1.3rem;
    padding: 12px 36px;
    border-radius: 30px;
    border: none;
    cursor: pointer;
    box-shadow: none;
    transition: background-color 0.3s ease, transform 0.15s ease;
    user-select: none;
  }
  button:active {
    transform: scale(0.95);
  }
  #seguirBtn {
    background-color: #2ecc71; /* verde */
    color: white;
  }
  #seguirBtn:hover {
    background-color: #27ae60;
  }
  #quedarseBtn {
    background-color: #e74c3c; /* rojo */
    color: white;
  }
  #quedarseBtn:hover {
    background-color: #c0392b;
  }
  #teamoBtn {
    background-color: #d46a9f; /* rosa bonito */
    color: white;
  }
  #teamoBtn:hover {
    background-color: #b04c7c;
  }

  /* Página S&V */
  #pageSV {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: #121212;
    color: #f4f4f4;
    z-index: 20;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    font-weight: 700;
    font-size: 5rem;
    text-align: center;
    user-select: none;
    opacity: 0;
    transition: opacity 0.8s ease;
  }
  #pageSV.show {
    display: flex;
    opacity: 1;
  }
  #pageSV h1 {
    font-size: 5.5rem;
    font-weight: 900;
    letter-spacing: 0.3em;
    color: #e74c3c;
    text-shadow: 0 0 15px #e74c3cbb;
    margin-bottom: 30px;
    transition: opacity 0.8s ease;
    user-select: none;
  }
  iframe {
    border-radius: 16px;
    box-shadow: 0 0 30px #e74c3caa;
    width: 90vw;
    max-width: 720px;
    height: 405px;
    border: none;
    user-select: none;
  }

  /* Fade in/out clases */
  .fade-in {
    animation: fadeIn 0.8s ease forwards;
  }
  .fade-out {
    animation: fadeOut 0.8s ease forwards;
  }
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  /* Lluvia TE AMO */
  #teAmoOverlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    background: #000;
    z-index: 50;
    pointer-events: none;
    overflow: hidden;
  }
  .teAmoText {
    position: absolute;
    font-weight: 900;
    font-size: 2.3rem;
    color: #e86abf;
    user-select: none;
    pointer-events: none;
    font-family: 'Poppins', sans-serif;
    text-shadow: 0 0 6px #ff66cccc;
    white-space: nowrap;
  }
</style>
</head>
<body>
  <audio id="jazzAudio" src="https://cdn.pixabay.com/download/audio/2022/10/23/audio_d011840f7c.mp3?filename=chill-jazz-14724.mp3" loop></audio>

  <canvas id="canvas"></canvas>

  <div id="mainText">
    aun estoy aprendiendo pero esto es para ti jsksjsk,<br> te amo mucho :3
  </div>

  <div id="buttons">
    <button id="seguirBtn">Seguir</button>
    <button id="quedarseBtn">Quedarse</button>
    <button id="teamoBtn">te amo</button>
  </div>

  <div id="pageSV" aria-label="Página S y V">
    <h1>S &amp; V</h1>
    <iframe
      src="https://www.youtube.com/embed/rgx_peYT9ZY?si=-ZjeThUgL1sJVf7G"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen
      title="Video S y V"
    ></iframe>
  </div>

  <div id="teAmoOverlay"></div>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const mainText = document.getElementById('mainText');
  const buttons = document.getElementById('buttons');
  const seguirBtn = document.getElementById('seguirBtn');
  const quedarseBtn = document.getElementById('quedarseBtn');
  const teamoBtn = document.getElementById('teamoBtn');
  const pageSV = document.getElementById('pageSV');
  const teAmoOverlay = document.getElementById('teAmoOverlay');
  const jazzAudio = document.getElementById('jazzAudio');

  let W, H;
  function resize() {
    W = window.innerWidth;
    H = window.innerHeight;
    canvas.width = W;
    canvas.height = H;
    teAmoOverlay.style.width = W + 'px';
    teAmoOverlay.style.height = H + 'px';
  }
  window.addEventListener('resize', resize);
  resize();

  // PARTICULAS CORAZÓN
  class Particle {
    constructor(x, y, color) {
      this.x = x;
      this.y = y;
      this.destX = x;
      this.destY = y;
      this.vx = (Math.random() - 0.5) * 3;
      this.vy = (Math.random() - 0.5) * 3;
      this.color = color;
      this.radius = 2.2;
      this.friction = 0.88;
      this.ease = 0.12;
    }
    draw() {
      ctx.beginPath();
      ctx.fillStyle = this.color;
      ctx.shadowColor = this.color;
      ctx.shadowBlur = 0;
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
      ctx.fill();
    }
    update() {
      let dx = this.destX - this.x;
      let dy = this.destY - this.y;
      this.vx += dx * this.ease;
      this.vy += dy * this.ease;

      this.vx *= this.friction;
      this.vy *= this.friction;

      this.x += this.vx;
      this.y += this.vy;
    }
  }

  // CREA PUNTOS PARA CORAZÓN (más pequeño)
  function createHeartPoints(centerX, centerY, size, count) {
    const points = [];
    for (let i = 0; i < count; i++) {
      let t = i / count * Math.PI * 2;
      let x = 16 * Math.pow(Math.sin(t), 3);
      let y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2*Math.cos(3*t) - Math.cos(4*t);
      points.push({
        x: centerX + x * size,
        y: centerY - y * size
      });
    }
    return points;
  }

  // PARTICULAS MINI CORAZÓN LLUVIA
  class MiniHeart {
    constructor(x, y, color) {
      this.x = x;
      this.y = y;
      this.vy = -1.2 - Math.random() * 1.6;
      this.radius = 5;
      this.color = color;
      this.opacity = 1;
    }
    draw() {
      ctx.save();
      ctx.fillStyle = this.color;
      ctx.globalAlpha = this.opacity;
      ctx.beginPath();
      const x = this.x;
      const y = this.y;
      const r = this.radius;
      ctx.moveTo(x, y);
      ctx.bezierCurveTo(x - r/2, y - r/2, x - r, y + r/3, x, y + r);
      ctx.bezierCurveTo(x + r, y + r/3, x + r/2, y - r/2, x, y);
      ctx.fill();
      ctx.restore();
    }
    update() {
      this.y += this.vy;
      this.opacity -= 0.01;
      if(this.opacity < 0) this.opacity = 0;
    }
    isDead() {
      return this.opacity <= 0;
    }
  }

  // PARTICULAS FUEGO LLUVIA
  class FireParticle {
    constructor(x, y) {
      this.x = x;
      this.y = y;
      this.vy = -1 - Math.random() * 2;
      this.vx = (Math.random() - 0.5) * 1.2;
      this.radius = 4 + Math.random() * 2;
      this.opacity = 1;
      this.color = `rgba(255,${120 + Math.floor(Math.random()*80)},0,`;
    }
    draw() {
      ctx.save();
      let gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.radius);
      gradient.addColorStop(0, this.color + this.opacity + ')');
      gradient.addColorStop(1, this.color + '0)');
      ctx.fillStyle = gradient;
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
      ctx.fill();
      ctx.restore();
    }
    update() {
      this.x += this.vx;
      this.y += this.vy;
      this.opacity -= 0.02;
      if(this.opacity < 0) this.opacity = 0;
    }
    isDead() {
      return this.opacity <= 0;
    }
  }

  // PARTICULAS TE AMO (texto)
  class TeAmoText {
    constructor() {
      this.x = Math.random() * W;
      this.y = -30 - Math.random() * 50;
      this.speed = 1 + Math.random() * 2;
      this.opacity = 1;
      this.size = 18 + Math.random() * 24;
      this.element = document.createElement('div');
      this.element.className = 'teAmoText';
      this.element.textContent = 'TE AMO';
      this.element.style.fontSize = this.size + 'px';
      this.element.style.left = this.x + 'px';
      this.element.style.top = this.y + 'px';
      teAmoOverlay.appendChild(this.element);
    }
    update() {
      this.y += this.speed;
      this.opacity -= 0.005;
      this.element.style.top = this.y + 'px';
      this.element.style.opacity = this.opacity;
    }
    isDead() {
      if(this.opacity <= 0) {
        teAmoOverlay.removeChild(this.element);
        return true;
      }
      return false;
    }
  }

  // Variables para partículas
  const particleCount = 250;
  const centerX = W / 2;
  const centerY = H / 2.3;
  const heartSize = Math.min(W, H) / 23;
  const heartPoints = createHeartPoints(centerX, centerY, heartSize, particleCount);

  let particles = [];
  for (let i = 0; i < particleCount; i++) {
    let px = Math.random() * W;
    let py = Math.random() * H;
    let p = new Particle(px, py, 'rgba(204,74,63,0.9)');
    p.destX = heartPoints[i].x;
    p.destY = heartPoints[i].y;
    particles.push(p);
  }

  let animationPhase = 'formingHeart';
  let miniHearts = [];
  let fireParticles = [];
  let teAmoTexts = [];

  function drawCenteredText() {
    mainText.style.display = 'block';
  }

  function animate() {
    ctx.clearRect(0, 0, W, H);

    if(animationPhase === 'formingHeart') {
      let doneCount = 0;
      for(let p of particles) {
        p.update();
        p.draw();
        if(Math.abs(p.x - p.destX) < 0.4 && Math.abs(p.y - p.destY) < 0.4) doneCount++;
      }
      if(doneCount / particleCount > 0.9) {
        animationPhase = 'showButtons';
        buttons.style.display = 'flex';
        drawCenteredText();
        jazzAudio.play().catch(() => {});
      }
    } else if(animationPhase === 'showButtons' || animationPhase === 'stayed') {
      for(let p of particles) p.draw();

      if(animationPhase === 'stayed') {
        if(Math.random() < 0.12) {
          miniHearts.push(new MiniHeart(Math.random() * W, H + 20, 'rgba(204,74,63,0.9)'));
        }
        for(let i = miniHearts.length -1; i >= 0; i--) {
          let h = miniHearts[i];
          h.update();
          h.draw();
          if(h.isDead()) miniHearts.splice(i, 1);
        }
      }
    } else if(animationPhase === 'seguido') {
      ctx.clearRect(0, 0, W, H);

      if(Math.random() < 0.25) {
        fireParticles.push(new FireParticle(Math.random() * W, H + 20));
      }
      for(let i = fireParticles.length -1; i >= 0; i--) {
        let f = fireParticles[i];
        f.update();
        f.draw();
        if(f.isDead()) fireParticles.splice(i, 1);
      }
    } else if(animationPhase === 'teamo') {
      ctx.clearRect(0, 0, W, H);
      for(let p of particles) p.draw();

      if(Math.random() < 0.3) {
        teAmoTexts.push(new TeAmoText());
      }
      for(let i = teAmoTexts.length -1; i >= 0; i--) {
        let t = teAmoTexts[i];
        t.update();
        if(t.isDead()) teAmoTexts.splice(i, 1);
      }
    }

    requestAnimationFrame(animate);
  }

  seguirBtn.onclick = () => {
    mainText.classList.add('fade-out');
    buttons.classList.add('fade-out');
    jazzAudio.pause();

    setTimeout(() => {
      mainText.style.display = 'none';
      buttons.style.display = 'none';

      pageSV.classList.add('show');
    }, 800);

    animationPhase = 'seguido';
  };
  quedarseBtn.onclick = () => {
    animationPhase = 'stayed';
    buttons.style.display = 'none';
    mainText.style.display = 'none';
  };
  teamoBtn.onclick = () => {
    animationPhase = 'teamo';
    buttons.style.display = 'none';
    mainText.style.display = 'none';
    teAmoOverlay.style.pointerEvents = 'auto';
  };

  window.onload = () => {
    mainText.style.display = 'block';
    buttons.style.display = 'flex';
  }

  animate();
</script>
</body>
</html>